const {
    SlashCommandBuilder,
    StringSelectMenuBuilder,
    StringSelectMenuOptionBuilder,
    EmbedBuilder,
    ActionRowBuilder,
    ButtonStyle,
    ButtonBuilder
} = require("discord.js");
const { Database } = require("st.db");

const db = new Database("/database/data");
const setting = new Database("/database/settingsdata/setting");
const image = new Database("/database/settingsdata/image");

module.exports = {
    ownersOnly: true,
    data: new SlashCommandBuilder()
        .setName('send-maker-uptime')
        .setDescription(`Ø§Ø±Ø³Ø§Ù„ Ø¨Ø§Ù†Ù„ Ø§Ù„Ø§Ø¨ØªØ§ÙŠÙ… Ø§Ù„Ù…ÙŠÙƒØ±Ø§Øª`),
    async execute(interaction) {
        await interaction.deferReply({ ephemeral: true });

        let price1 = await setting.get(`balance_price_${interaction.guild.id}`) ?? 5000;
        let logroom = await setting.get(`log_room_${interaction.guild.id}`);
        let probot = await setting.get(`probot_${interaction.guild.id}`);
        let clientrole = await setting.get(`client_role_${interaction.guild.id}`);
        let message5 = await setting.get(`message7_${interaction.guild.id}`);
        let image5 = await image.get(`image5_${interaction.guild.id}`);
        let uptimeroom1 = await setting.get(`uptimeroom_${interaction.guild.id}`);

        if (!price1 || !logroom || !probot || !clientrole || !uptimeroom1) {
            return interaction.editReply({ content: `**Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø¹Ø¯Ø§Ø¯Ø§Øª**` });
        }
    let uptimeroom323 = interaction.guild.channels.cache.find(ch => ch.id == uptimeroom1)
            let uptimeEmbed = new EmbedBuilder()
                .setTitle(`**Ø¨Ø§Ù†Ù„ Ø´Ø±Ø§Ø¡ Ø§Ù„Ø§Ø¨ØªØ§ÙŠÙ…**`)
                .setThumbnail(interaction.guild.iconURL())
            .setTimestamp()
                .setTimestamp()
                .setThumbnail(interaction.guild.iconURL({ dynamic: true }))
                if (message5){
                    let message1 = message5.replace(/\\n/g, '\n');
                    uptimeEmbed.setDescription(`${message1}`)
                }
                if (image5){
                    uptimeEmbed.setImage(`${image5}`)
                }

            const select = new StringSelectMenuBuilder()
                .setCustomId('uptime_select')
                .setPlaceholder(' ğŸ›’ Ø§Ø®ØªØ± Ø®Ø·Ø© Ù„ØªÙŠ ØªØ³Ø§Ø¹Ø¯Ùƒ')
                .addOptions(
                    new StringSelectMenuOptionBuilder()
                        .setLabel(`Ø§Ø¨ØªØ§ÙŠÙ… Ø§Ø³Ø¨ÙˆØ¹ÙŠ`)
                        .setDescription(`Ø´Ø±Ø§Ø¡ Ø§Ø¨ØªØ§ÙŠÙ… Ù„Ù…Ø¯Ø© Ø§Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· Ù…Ù‚Ø§Ø¨Ù„ 35 Ø¹Ù…Ù„Ø©`)
                        .setEmoji(`ğŸ›©`)
                        .setValue('weekly_uptime'),
                    new StringSelectMenuOptionBuilder()
                        .setLabel(`Ø§Ø¨ØªØ§ÙŠÙ… Ø´Ù‡Ø±ÙŠ`)
                        .setDescription(`Ø´Ø±Ø§Ø¡ Ø§Ø¨ØªØ§ÙŠÙ… Ù„Ù…Ø¯Ø© Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ Ù…Ù‚Ø§Ø¨Ù„ 100 Ø¹Ù…Ù„Ø©`)
                        .setEmoji(`ğŸš€`)
                        .setValue('monthly_uptime'),
                    new StringSelectMenuOptionBuilder()
                        .setLabel(`Ø­Ø°Ù Ø±Ø§Ø¨Ø·`)
                        .setDescription(`Ø­Ø°Ù Ø±Ø§Ø¨Ø· Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Ø§Ù„Ø§Ø¨ØªØ§ÙŠÙ…`)
                        .setEmoji(`â›”`)
                        .setValue('delete_uptime')
                );

            const row3 = new ActionRowBuilder()
                .addComponents(select);

        const free = new ButtonBuilder()
            .setCustomId(`showup`)
            .setEmoji('â•')
            .setStyle(ButtonStyle.Primary);
        
        const row4 = new ActionRowBuilder()
        .addComponents(free,);

            await uptimeroom323.send({embeds: [uptimeEmbed],components: [row3,row4]});

            return interaction.editReply({ content: `**ØªÙ… Ø§Ø±Ø³Ø§Ù„ Ø¨Ø§Ù†Ù„ Ø§Ù„Ø§Ø¨ØªØ§ÙŠÙ…**` });
        
    }
};